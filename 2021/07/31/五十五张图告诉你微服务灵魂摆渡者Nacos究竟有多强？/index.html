<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"chenjiabing666.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言Nacos是阿里巴巴开源的服务注册中心以及配置中心，致力于给开发者提供一款便捷、简单上手的开源框架。 Nacos究竟有什么惊人的地方呢？看下图：  从上图不难看出阿里巴巴的野心，一个Nacos干掉了Spring Cloud的三大组件，分别是注册中心Eureka、服务配置Config，服务总线Bus。 本文目录结构如下图：">
<meta property="og:type" content="article">
<meta property="og:title" content="五十五张图告诉你微服务灵魂摆渡者Nacos究竟有多强？">
<meta property="og:url" content="https://chenjiabing666.github.io/2021/07/31/%E4%BA%94%E5%8D%81%E4%BA%94%E5%BC%A0%E5%9B%BE%E5%91%8A%E8%AF%89%E4%BD%A0%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%81%B5%E9%AD%82%E6%91%86%E6%B8%A1%E8%80%85Nacos%E7%A9%B6%E7%AB%9F%E6%9C%89%E5%A4%9A%E5%BC%BA%EF%BC%9F/index.html">
<meta property="og:site_name" content="不才陈某技术博客">
<meta property="og:description" content="前言Nacos是阿里巴巴开源的服务注册中心以及配置中心，致力于给开发者提供一款便捷、简单上手的开源框架。 Nacos究竟有什么惊人的地方呢？看下图：  从上图不难看出阿里巴巴的野心，一个Nacos干掉了Spring Cloud的三大组件，分别是注册中心Eureka、服务配置Config，服务总线Bus。 本文目录结构如下图：">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/1.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/53.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/2.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/3.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/7.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/4.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/5.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/6.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/8.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/9.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/10.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/11.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/12.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/9.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/13.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/14.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/15.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/16.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/17.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/18.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/19.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/20.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/21.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/22.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/23.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/24.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/25.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/26.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/25.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/27.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/28.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/29.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/30.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/31.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/32.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/33.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/34.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/36.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/35.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/43.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/44.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/37.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/38.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/39.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/40.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/41.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/42.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/45.jpg">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/46.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/47.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/48.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/49.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/50.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/51.png">
<meta property="og:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/52.png">
<meta property="article:published_time" content="2021-07-31T09:48:36.000Z">
<meta property="article:modified_time" content="2021-10-08T02:18:59.098Z">
<meta property="article:author" content="不才陈某">
<meta property="article:tag" content="Spring Cloud">
<meta property="article:tag" content="Nacos">
<meta property="article:tag" content="微服务">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/1.png">

<link rel="canonical" href="https://chenjiabing666.github.io/2021/07/31/%E4%BA%94%E5%8D%81%E4%BA%94%E5%BC%A0%E5%9B%BE%E5%91%8A%E8%AF%89%E4%BD%A0%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%81%B5%E9%AD%82%E6%91%86%E6%B8%A1%E8%80%85Nacos%E7%A9%B6%E7%AB%9F%E6%9C%89%E5%A4%9A%E5%BC%BA%EF%BC%9F/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>五十五张图告诉你微服务灵魂摆渡者Nacos究竟有多强？ | 不才陈某技术博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">不才陈某技术博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">微信公众号：码猿技术专栏</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
		<div id="container">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://chenjiabing666.github.io/2021/07/31/%E4%BA%94%E5%8D%81%E4%BA%94%E5%BC%A0%E5%9B%BE%E5%91%8A%E8%AF%89%E4%BD%A0%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%81%B5%E9%AD%82%E6%91%86%E6%B8%A1%E8%80%85Nacos%E7%A9%B6%E7%AB%9F%E6%9C%89%E5%A4%9A%E5%BC%BA%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="不才陈某">
      <meta itemprop="description" content="本站是不才陈某的技术分享博客。内容涵盖Java后端技术、Spring Boot、微服务架构、系统安全、前端、系统监控等相关的研究与知识分享。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="不才陈某技术博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          五十五张图告诉你微服务灵魂摆渡者Nacos究竟有多强？
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-31 17:48:36" itemprop="dateCreated datePublished" datetime="2021-07-31T17:48:36+08:00">2021-07-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-08 10:18:59" itemprop="dateModified" datetime="2021-10-08T10:18:59+08:00">2021-10-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring-Cloud-%E8%BF%9B%E9%98%B6/" itemprop="url" rel="index"><span itemprop="name">Spring Cloud 进阶</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/07/31/%E4%BA%94%E5%8D%81%E4%BA%94%E5%BC%A0%E5%9B%BE%E5%91%8A%E8%AF%89%E4%BD%A0%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%81%B5%E9%AD%82%E6%91%86%E6%B8%A1%E8%80%85Nacos%E7%A9%B6%E7%AB%9F%E6%9C%89%E5%A4%9A%E5%BC%BA%EF%BC%9F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/07/31/%E4%BA%94%E5%8D%81%E4%BA%94%E5%BC%A0%E5%9B%BE%E5%91%8A%E8%AF%89%E4%BD%A0%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%81%B5%E9%AD%82%E6%91%86%E6%B8%A1%E8%80%85Nacos%E7%A9%B6%E7%AB%9F%E6%9C%89%E5%A4%9A%E5%BC%BA%EF%BC%9F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Nacos是阿里巴巴开源的服务注册中心以及配置中心，致力于给开发者提供一款便捷、简单上手的开源框架。</p>
<p>Nacos究竟有什么惊人的地方呢？看下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/1.png"></p>
<p>从上图不难看出阿里巴巴的野心，一个Nacos干掉了Spring Cloud的三大组件，分别是<code>注册中心Eureka</code>、<code>服务配置Config</code>，<code>服务总线Bus</code>。</p>
<p>本文目录结构如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/53.png"></p>
<span id="more"></span>

<h2 id="为什么Nacos这么受欢迎？"><a href="#为什么Nacos这么受欢迎？" class="headerlink" title="为什么Nacos这么受欢迎？"></a>为什么Nacos这么受欢迎？</h2><p>Nacos官方文档的介绍中有这么一句话，如下：</p>
<blockquote>
<p>Nacos 帮助您更敏捷和容易地构建、交付和管理微服务平台。 Nacos 是构建以“服务”为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施。</p>
</blockquote>
<p>什么意思呢？不着急，有对比才有伤害。</p>
<p><code>Eureka</code>、<code>Config</code>这两个组件相信大家都用过，有什么感受？</p>
<p>当然，这两个组件给我最直观的感受就是繁琐，原因如下：</p>
<ol>
<li>无论是Eureka还是Config都必须自己搭建个服务</li>
<li>英文界面不是那么友好</li>
</ol>
<p>用过Nacos的开发者都说很爽，不用自己搭建服务，阿里给你准备好了服务，只需要启动即可；界面中英文都有，很适合初学者。</p>
<p>当然最重要的原因就是以上组件很可能面临<code>停更</code>、比如Eureka已经停更了，谁知道后面其他的组件会不会如此呢？</p>
<h2 id="如何自学呢？"><a href="#如何自学呢？" class="headerlink" title="如何自学呢？"></a>如何自学呢？</h2><p>对于初学者当然是官方文档了，下面作者列出了Nacos相关的官方文档：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://nacos.io/zh-cn/docs/what-is-nacos.html%EF%BC%88%E4%B8%AD%E8%8B%B1%E6%96%87%E5%85%BC%E5%A4%87%EF%BC%89">https://nacos.io/zh-cn/docs/what-is-nacos.html（中英文兼备）</a></li>
<li><a target="_blank" rel="noopener" href="https://spring-cloud-alibaba-group.github.io/github-pages/hoxton/en-us/index.html%EF%BC%88%E8%8B%B1%E6%96%87%EF%BC%89">https://spring-cloud-alibaba-group.github.io/github-pages/hoxton/en-us/index.html（英文）</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/nacos%EF%BC%88Nacos%E9%A1%B9%E7%9B%AE%E4%BB%93%E5%BA%93%EF%BC%89">https://github.com/alibaba/nacos（Nacos项目仓库）</a></li>
</ul>
<p>当然很多人不愿意看官方文档，作者也在为大家准备了视频教程。</p>
<blockquote>
<p>公众号<code>码猿技术专栏</code>回复关键词<code>9527</code>免费获取。</p>
</blockquote>
<h2 id="本文版本说明"><a href="#本文版本说明" class="headerlink" title="本文版本说明"></a>本文版本说明</h2><p>基于Maven构建的微服务项目，各个组件版本如下：</p>
<ul>
<li>JDK1.8+</li>
<li>Spring Boot-2.2.2.RELEASE</li>
<li>SpringCloud-Hoxton.SR3</li>
<li>SpringCloud Alibaba-2.2.1.RELEASE</li>
</ul>
<p><strong>注意</strong>：Spring Boot、Spring Cloud、Spring Cloud Alibaba的版本可不是随便选择的，官网明确规定了各个版本的适配：<a target="_blank" rel="noopener" href="https://github.com/alibaba/spring-cloud-alibaba/wiki%EF%BC%8C%E5%A6%82%E4%B8%8B%E5%9B%BE%EF%BC%9A">https://github.com/alibaba/spring-cloud-alibaba/wiki，如下图：</a></p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/2.png"></p>
<p>不同版本的Alibaba也对应了不同组件的版本，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/3.png"></p>
<blockquote>
<p>一定要完全按照文档给出的版本来选择，不然会出现意想不到的BUG，那岂不是鸡鸡….</p>
</blockquote>
<p>作者使用的是分模块的聚合项目演示，其中<code>dependencyManagement</code>依赖如下，对应着上文提到的版本：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/7.png"></p>
<blockquote>
<p>注意：如果你的版本的不是和作者一样，请一定严格按照官方文档给的版本进行适配，否则会有意想不到的BUG….</p>
</blockquote>
<h2 id="启动Nacos服务"><a href="#启动Nacos服务" class="headerlink" title="启动Nacos服务"></a>启动Nacos服务</h2><p>根据上面作者选择的Spring Cloud Alibaba的版本，对应的Nacos版本是<code>1.2.1</code>，直接去GitHub(<a target="_blank" rel="noopener" href="https://github.com/alibaba/nacos/tags)%E4%B8%8B%E8%BD%BD%E5%AF%B9%E5%BA%94%E7%9A%84%E7%89%88%E6%9C%AC%E5%8D%B3%E5%8F%AF%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%89%E6%8B%A9windows%E6%88%96%E8%80%85Linux%EF%BC%8C%E5%A6%82%E4%B8%8B%E5%9B%BE%EF%BC%9A">https://github.com/alibaba/nacos/tags)下载对应的版本即可，可以选择windows或者Linux，如下图：</a></p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/4.png"></p>
<p>下载完成之后直接解压即可，从它的目录结构和文件名称一看这就是一个Spring Boot 项目。</p>
<p>进入<code>/bin</code>目录，有两个脚本，如下：</p>
<ul>
<li><code>startup.cmd</code>：windows平台的启动脚本</li>
<li><code>startup.sh</code>：Linux平台的启动脚本</li>
</ul>
<p>由于作者本地是windows，直接双击<code>startup.cmd</code>启动项目，出现以下界面则启动完成：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/5.png"></p>
<p>在浏览器输入<code>http://localhost:8848/nacos</code>进入Nacos的登录界面。</p>
<blockquote>
<p>用户名：nacos；密码：nacos</p>
</blockquote>
<p>登录成功的界面如下：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/6.png"></p>
<h2 id="服务注册发现"><a href="#服务注册发现" class="headerlink" title="服务注册发现"></a>服务注册发现</h2><p>微服务的服务注册和发现相信都用过Eureka，要自己本地构建一个Eureka微服务，但是整合了Alibaba的Nacos则不用那么复杂，直接启动Alibaba提供的Nacos服务即可，这样让程序员把全部精力放在业务上，下面是一个简单的架构图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/8.png"></p>
<h3 id="如何演示效果呢？"><a href="#如何演示效果呢？" class="headerlink" title="如何演示效果呢？"></a>如何演示效果呢？</h3><p>参照上面架构图，作者分别创建了两个模块，分别是<code>nacos-provider</code>(服务提供者)、<code>nacos-consumer</code>(服务消费者)，职责如下：</p>
<ul>
<li><code>nacos-provider</code>：注册进入nacos-server，对外暴露服务</li>
<li><code>nacos-consumer</code>：注册进入nacos-server，调用nacos-provider的服务</li>
</ul>
<h3 id="nacos-provider服务提供者创建"><a href="#nacos-provider服务提供者创建" class="headerlink" title="nacos-provider服务提供者创建"></a>nacos-provider服务提供者创建</h3><p>由于使用了多模块聚合项目，只需要创建一个nacos-provider模块即可。步骤如下：</p>
<h4 id="1-添加Maven依赖"><a href="#1-添加Maven依赖" class="headerlink" title="1. 添加Maven依赖"></a>1. 添加Maven依赖</h4><p>需要添加<code>spring-cloud-starter-alibaba-nacos-discovery</code>这个依赖，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/9.png"></p>
<p>由于父模板中指定了<code>spring-cloud-alibaba-dependencies</code>的版本，子模块中直接引入依赖即可，不需要指定版本号，这样才能达到版本管理的效果。</p>
<h4 id="2-配置YML文件"><a href="#2-配置YML文件" class="headerlink" title="2. 配置YML文件"></a>2. 配置YML文件</h4><p>在配置文件中指定服务名称、端口号、nacos-server的地址等信息，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: 9001</span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    ## 指定服务名称，在nacos中的名字</span><br><span class="line">    name: nacos-provider</span><br><span class="line">  cloud:</span><br><span class="line">    nacos:</span><br><span class="line">      discovery:</span><br><span class="line">        # nacos的服务地址，nacos-server中IP地址:端口号</span><br><span class="line">        server-addr: 127.0.0.1:8848</span><br><span class="line">management:</span><br><span class="line">  endpoints:</span><br><span class="line">    web:</span><br><span class="line">      exposure:</span><br><span class="line">        ## yml文件中存在特殊字符，必须用单引号包含，否则启动报错</span><br><span class="line">        include: &#x27;*&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="3-开启服务注册发现功能"><a href="#3-开启服务注册发现功能" class="headerlink" title="3. 开启服务注册发现功能"></a>3. 开启服务注册发现功能</h4><p>这个大部分Spring Boot功能模块相同，都需要使用<code>@EnableXxxx</code>注解来开启某个功能，否则无法引入自动配置。这里需要使用Spring Cloud的原生注解<code>@EnableDiscoveryClient</code>来开启服务注册发现的功能，如下：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/10.png"></p>
<h4 id="4-写个演示服务"><a href="#4-写个演示服务" class="headerlink" title="4. 写个演示服务"></a>4. 写个演示服务</h4><p>nacos-provider作为服务提供者注册到nacos中，肯定需要提供个服务来供消费者（nacos-consumer）调用，下面是随便写的一个接口：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/11.png"></p>
<h4 id="5-启动项目"><a href="#5-启动项目" class="headerlink" title="5. 启动项目"></a>5. 启动项目</h4><p>按照上面的5个步骤算是完成了最基本的一个服务，现在只需要启动nacos-provider这个服务即可。</p>
<p>启动成功之后在nacos的服务管理-&gt;服务列表这里将会发现注册进入的nacos-provider这个服务，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/12.png"></p>
<p>OK，在nacos中能够看到服务注册成功了，完成任务……….</p>
<h3 id="nacos-consumer服务消费者创建"><a href="#nacos-consumer服务消费者创建" class="headerlink" title="nacos-consumer服务消费者创建"></a>nacos-consumer服务消费者创建</h3><p>同样是注册进入nacos，因此大致步骤都是一样的，步骤如下：</p>
<h4 id="1-添加Maven依赖-1"><a href="#1-添加Maven依赖-1" class="headerlink" title="1. 添加Maven依赖"></a>1. 添加Maven依赖</h4><p>需要添加<code>spring-cloud-starter-alibaba-nacos-discovery</code>这个依赖，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/9.png"></p>
<h4 id="2-配置YML文件-1"><a href="#2-配置YML文件-1" class="headerlink" title="2. 配置YML文件"></a>2. 配置YML文件</h4><p>同样是指定服务名、端口、nacos-server的地址，如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9002</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-consumer</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="comment"># nacos的服务地址</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="comment">## yml文件中存在特殊字符，必须用单引号包含，否则启动报错</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="3-开启服务注册发现功能-1"><a href="#3-开启服务注册发现功能-1" class="headerlink" title="3. 开启服务注册发现功能"></a>3. 开启服务注册发现功能</h4><p>使用<code>@EnableDiscoveryClient</code>标注，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/13.png"></p>
<h4 id="4-写个演示服务-1"><a href="#4-写个演示服务-1" class="headerlink" title="4. 写个演示服务"></a>4. 写个演示服务</h4><p>如何演示呢？nacos-provider提供了一个服务，那么我们就调用它的服务来演示一把。</p>
<p>其实Nacos集成了Ribbon，何以见得呢？打开<code>spring-cloud-starter-alibaba-nacos-discovery</code>的依赖一看便知，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/14.png"></p>
<p>因此我们便能使用Ribbon的负载均衡来调用服务，步骤如下：</p>
<ul>
<li>创建RestTemplate，使用<code>@LoadBalanced</code>注解标注开启负载均衡，如下图：</li>
</ul>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/15.png"></p>
<ul>
<li>直接使用注册到nacos的中的服务名作为访问地址调用服务，如下图：</li>
</ul>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/16.png"></p>
<ul>
<li>上图中的<code>serviceUrl</code>是什么东西呢？难道是IP地址？当然不是，既然nacos-provider和nacos-consumer都已经注册到nacos中，那么可能是可以直接通过服务名直接找到对应得服务，因此这个<code>serviceUrl=http://service-name</code>，如下图：</li>
</ul>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/17.png"></p>
<p>OK，至此nacos-consumer已经准备完成，下面就可以启动项目。</p>
<h4 id="5-启动项目-1"><a href="#5-启动项目-1" class="headerlink" title="5. 启动项目"></a>5. 启动项目</h4><p>启动成功之后将会在nacos中的服务列表中查看到两个服务，分别是nacos-provider、nacos-consumer，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/18.png"></p>
<p>此时服务提供者和消费者都已成功注册到Nacos，那么接下来就是测试服务能否调的通的问题了。</p>
<p>直接调用nacos-consumer的接口，输入地址：<code>http://localhost:9002/nacos/test/16</code>，返回信息如下图则表示相互调用成功：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/19.png"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Nacos的服务注册发现很简单，比Eureka简单多了，无需自己构建个注册中心。</p>
<h2 id="启动配置管理"><a href="#启动配置管理" class="headerlink" title="启动配置管理"></a>启动配置管理</h2><p>为什么要用配置管理？其实这已经不仅仅是微服务的痛点了，单体服务也存在这样的痛点。试问线上的项目如果想要的修改某个配置，比如添加一个数据源，难道要停服更新？显然是不太现实，那么如何解决呢？</p>
<p>对于单体应用前面已经写过一篇文章，感兴趣的可以看：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzU3MDAzNDg1MA==&mid=2247491723&idx=1&sn=4f335dfab579aac6cd40455d88f74fdb&chksm=fcf73f46cb80b6503898214461b5fe173319e46da76d8b5de531db6588a30cb0ccadf53fbdb6&token=1695818683&lang=zh_CN#rd">如何让Spring Boot 的配置 “动” 起来？</a></p>
<p>微服务环境下可选的方案还是很多的，比如Config+BUS，携程开源的Apollo….</p>
<p>这都不是今天的重点，用过Config+BUS觉得怎么样？自己要搭建一个Config微服务，还要集成GitHub等，你不难受吗？</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/20.png"></p>
<p>下面就来介绍一下Nacos是如何完美的实现配置管理以及动态刷新的。</p>
<h3 id="如何演示效果呢？-1"><a href="#如何演示效果呢？-1" class="headerlink" title="如何演示效果呢？"></a>如何演示效果呢？</h3><p>新建一个模块<code>nacos-config</code>用来整合Nacos实现配置管理，项目结构如下：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/21.png"></p>
<p>Nacos配置列表在哪里能看到呢？在管理平台-&gt;配置管理-&gt;配置列表这一栏，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/22.png"></p>
<h3 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h3><p>由于使用了模块聚合的工程，因此不需要指定版本号，依赖如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="配置YAML文件"><a href="#配置YAML文件" class="headerlink" title="配置YAML文件"></a>配置YAML文件</h3><p>在<code>bootstrap.yml</code>文件中设置Nacos的配置，如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-config</span></span><br><span class="line">    <span class="comment">## 当前环境，这个和dataId有关-&gt; $&#123;prefix&#125;-$&#123;spring.profiles.active&#125;.$&#123;file-extension&#125;</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="comment">## nacos的地址，作为配置中心</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line">        <span class="comment">## 配置内容的数据格式，目前只支持 properties 和 yaml 类型，这个和dataId有关-&gt; $&#123;prefix&#125;-$&#123;spring.profiles.active&#125;.$&#123;file-extension&#125;</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">properties</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="comment">## yml文件中存在特殊字符，必须用单引号包含，否则启动报错</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Data-ID是什么？"><a href="#Data-ID是什么？" class="headerlink" title="Data ID是什么？"></a>Data ID是什么？</h3><p>dataId是一个配置的唯一标识，怎么取值呢？格式如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;prefix&#125;-$&#123;spring.profiles.active&#125;.$&#123;file-extension&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>prefix</code>：前缀，默认是<code>spring.application.name</code>的值，也可以通过配置项 <code>spring.cloud.nacos.config.prefix</code>来配置。</li>
<li><code>spring.profiles.active</code>： 即为当前环境对应的 profile。当 <code>spring.profiles.active</code> 为空时，对应的连接符 <code>-</code> 也将不存在，dataId 的拼接格式变成 <code>$&#123;prefix&#125;.$&#123;file-extension&#125;</code></li>
<li><code>file-exetension</code> 为配置内容的数据格式，可以通过配置项 <code>spring.cloud.nacos.config.file-extension</code> 来配置。目前只支持 <code>properties</code> 和 <code>yaml</code> 类型。</li>
</ul>
<h3 id="添加一个配置"><a href="#添加一个配置" class="headerlink" title="添加一个配置"></a>添加一个配置</h3><p>下面在nacos中添加一个<code>config.version</code>的配置，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/23.png"></p>
<p>以上就是添加的<code>config.version</code>的配置，发布之后查看列表如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/24.png"></p>
<h3 id="获取nacos中的配置"><a href="#获取nacos中的配置" class="headerlink" title="获取nacos中的配置"></a>获取nacos中的配置</h3><p>获取nacos中的配置很简单，使用原生注解<code>@Value()</code>直接读取即可，步骤如下：</p>
<ul>
<li>新建一个实体类<code>DynamicConfigEntity</code>：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicConfigEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//直接读取nacos中config.version的配置</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;config.version&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String version;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>新建一个controller测试，如下：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/nacos&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NacosController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DynamicConfigEntity entity;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/test/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span>Integer id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;accept one msg id=&quot;</span>+id+<span class="string">&quot;----- version=&quot;</span>+entity.getVersion();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行项目成功后，在浏览器输入地址：<a target="_blank" rel="noopener" href="http://localhost:9003/nacos/test/1%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%A6%82%E4%B8%8B%E7%BB%93%E6%9E%9C%EF%BC%9A">http://localhost:9003/nacos/test/1，返回如下结果：</a></p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/25.png"></p>
<p>结果很明显，Nacos中的配置生效了，是不是很简单？</p>
<h3 id="配置如何动态刷新？"><a href="#配置如何动态刷新？" class="headerlink" title="配置如何动态刷新？"></a>配置如何动态刷新？</h3><p>设想一下：现在由于需求改变了，我需要将<code>config.version</code>这个配置改成2，那么我直接改变Nacos中的配置会生效吗？</p>
<p>不妨试一下，直接将Nacos中的配置修改成2，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/26.png"></p>
<p>此时我们再不重启项目的情况下访问：<a target="_blank" rel="noopener" href="http://localhost:9003/nacos/test/1%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%EF%BC%9A">http://localhost:9003/nacos/test/1，结果如下图：</a></p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/25.png"></p>
<p>what？？？怎么没变呢？不是说Nacos可以自动刷新配置吗？</p>
<p>其实想要Nacos自动刷新配置还需要结合原生注解<code>@RefreshScope</code>，这个注解是不是很眼熟，在Config中也是用这个注解刷新配置，我们只需要将该注解标注在配置的实体类上即可，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RefreshScope</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicConfigEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//直接读取nacos中config.version的配置</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;config.version&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String version;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时加上<code>@RefreshScope</code>重启之后将Nacos中<code>config.version</code>这个配置改成3，然后访问<a target="_blank" rel="noopener" href="http://localhost:9003/nacos/test/1%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%EF%BC%9A">http://localhost:9003/nacos/test/1，结果如下图：</a></p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/27.png"></p>
<h3 id="多环境如何隔离配置？（Namespace）"><a href="#多环境如何隔离配置？（Namespace）" class="headerlink" title="多环境如何隔离配置？（Namespace）"></a>多环境如何隔离配置？（Namespace）</h3><p>试想一下：正常的业务开发至少有三个环境吧，如下：</p>
<ul>
<li>dev：本地开发环境</li>
<li>test：测试环境</li>
<li>prod：生产环境</li>
</ul>
<p>那么每个环境的配置肯定是不同的，那么问题来了，如何将以上三种不同的配置在Nacos能够很明显的区分呢？</p>
<p>很多人可能会问：<code>DataId</code>格式中不是有环境的区分吗？这个不是可以满足吗？</p>
<p><code>DataId</code>当然能够区分，但是微服务配置可不止这几个啊？一旦多了你怎么查找呢？多种环境的配置杂糅到一起，你好辨别吗？</p>
<p>当然阿里巴巴的Nacos开发团队显然考虑到了这种问题，官方推荐用命名空间（namespace）来解决环境配置隔离的问题。</p>
<blockquote>
<p>Namespace（命名空间）：解决多环境及多租户数据的隔离问题<br>在多套不同的环境下，可以根据指定的环境创建不同的Namespace，实现多环境的数据隔离</p>
</blockquote>
<p>Nacos中默认提供的命名空间则是<code>public</code>，上述我们创建的<code>config.version</code>这个配置就属于<code>public</code>这个命名空间，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/28.png"></p>
<p>当然我们可以根据业务需要创建自己的命名空间，操作如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/29.png"></p>
<p>陈某创建了三个，分别是dev、test、prod，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/30.png"></p>
<blockquote>
<p>注意：上图中的<code> 命名空间ID</code>是系统自动生成的唯一ID，后续指定不同的Namespace就用这个ID。</p>
</blockquote>
<p>创建完成之后，在配置列表上方则可以看见不同的命名空间，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/31.png"></p>
<p>既然Nacos中的Namespace配置好了，那么微服务中如何配置呢？前面也说过，Nacos默认指定的命名空间是<code>public</code>，那么如何在项目中指定命名空间呢？</p>
<p>其实很简单，假设在<code>test</code>这个命名空间中添加一个<code>config.version=4</code>，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/32.png"></p>
<p>此时只需要在<code>bootstrap.yml</code>配置中指定如下配置：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-config</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">      <span class="comment">## namespace的取值是命名空间ID，这里取的是test命名空间ID</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">d0ffeec2-3deb-4540-9664-fdd77461fd6b</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：Namespace必须在<code>bootstrap.yml</code>配置文件中指定，否则不生效。</p>
</blockquote>
<p>至此，已经全部配置完毕，启动项目，浏览器访问<a target="_blank" rel="noopener" href="http://localhost:9003/nacos/test/1%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%EF%BC%9A">http://localhost:9003/nacos/test/1，结果如下图：</a></p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/33.png"></p>
<h3 id="不同业务配置如何隔离？-Group"><a href="#不同业务配置如何隔离？-Group" class="headerlink" title="不同业务配置如何隔离？(Group)"></a>不同业务配置如何隔离？(Group)</h3><p>试想以下场景：有两个微服务，一个是订单系统，一个是用户系统，但是他们有着相同的配置，比如<code>datasource-url</code>，那么如何区分呢？</p>
<p>此时Group就派上用场了，顾名思义Group是分组的意思。</p>
<blockquote>
<p>Group：Nacos 中的一组配置集，是组织配置的维度之一，简单的说则是不同的系统或微服务的配置文件可以放在一个组里。Nacos如果不指定Group，则默认的分组是DEFAULT_GROUP。</p>
</blockquote>
<p>上述场景中订单系统、用户系统可以单独分为一个组，比如<code>ORDER_GROUP</code>、<code>USER_GROUP</code>。当然这是比较细粒度的分组，根据企业的业务也可以多个微服务分为一组。</p>
<p>下面在Nacos中新建一个<code>config.version=5</code>，命名空间为<code>test</code>，分组为<code>ORDER_GROUP</code>，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/34.png"></p>
<p>此时命名空间<code>test</code>中的配置如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/36.png"></p>
<p>在<code>bootstrap.yml</code>配置文件中指定分组，配置如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-config</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="comment">## 指定命名空间</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">d0ffeec2-3deb-4540-9664-fdd77461fd6b</span></span><br><span class="line">        <span class="comment">## 指定分组为ORDER_GROUP</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">ORDER_GROUP</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：Group配置和Namespace一样，要在<code>bootstrap.yml</code>文件中配置。</p>
</blockquote>
<p>至此，已经全部配置完毕，启动项目，浏览器访问<a target="_blank" rel="noopener" href="http://localhost:9003/nacos/test/1%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%EF%BC%9A">http://localhost:9003/nacos/test/1，结果如下图：</a></p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/35.png"></p>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><p>Nacos实现配置管理和动态配置刷新很简单，总结如下步骤：</p>
<ol>
<li>添加对应<code>spring-cloud-starter-alibaba-nacos-config</code>依赖</li>
<li>使用原生注解<code>@Value()</code>导入配置</li>
<li>使用原生注解<code>@RefreshScope</code>刷新配置</li>
<li>根据自己业务场景做好多环境配置隔离(Namespace)、不同业务配置隔离(Group)</li>
<li>切记：命名空间和分组的配置一定要放在<code>bootstrap.yml</code>或者<code>bootstrap.properties</code>配置文件中</li>
</ol>
<h2 id="Nacos如何共享配置？"><a href="#Nacos如何共享配置？" class="headerlink" title="Nacos如何共享配置？"></a>Nacos如何共享配置？</h2><p>场景：一个项目的微服务数量逐渐增多，势必会有相同的配置，那么我们可以将相同的配置抽取出来作为项目中共有的配置，比如集群中的数据源信息..</p>
<p>Nacos的共享配置能够完美的解决上述问题，配置起来也是很简单，没办法，就是这么强大。</p>
<h3 id="Nacos中新建共享配置"><a href="#Nacos中新建共享配置" class="headerlink" title="Nacos中新建共享配置"></a>Nacos中新建共享配置</h3><p>陈某这里演示两个共享配置，<code>DataId</code>分别是<code>share-config1.properties</code>，<code>share-config2.properties</code>，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/43.png"></p>
<blockquote>
<p>注意：<code>DataId</code>一定要带有后缀<code>properties</code>或者<code>yml</code></p>
</blockquote>
<p><code>share-config1.properties</code>配置中的内容如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">database.url</span>=<span class="string">jdbc:mysql://112.111.0.135:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true</span></span><br></pre></td></tr></table></figure>

<p><code>share-config2.properties</code>配置中的内容如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">database.user</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure>

<h3 id="新建模块nacos-config-share"><a href="#新建模块nacos-config-share" class="headerlink" title="新建模块nacos-config-share"></a>新建模块nacos-config-share</h3><p>此处新建一个模块nacos-config-share来演示效果，依赖同<code>nacos-config</code></p>
<p><code>bootstrap.yml</code>配置如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-config-share</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="comment">## 指定命名空间</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">51f0479b-a88d-4646-902b-f2a063801502</span></span><br><span class="line">        <span class="comment">## nacos的地址，作为配置中心</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8848</span></span><br><span class="line">        <span class="comment">## 配置内容的数据格式，目前只支持 properties 和 yaml 类型，这个和dataId有关-&gt; $&#123;prefix&#125;-$&#123;spring.profiles.active&#125;.$&#123;file-extension&#125;</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">properties</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="comment">## yml文件中存在特殊字符，必须用单引号包含，否则启动报错</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure>

<p>以上的配置和<code>nacos-config</code>差不多，指定<code>application.name</code>、命名空间、<code>file-extension</code>、nacos服务地址….</p>
<p>当然除了以上配置肯定是不够的，要想共享配置还需要添加以下配置：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-config-share</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="comment">## 共享配置，List集合，可以配置多个</span></span><br><span class="line">        <span class="attr">shared-configs:</span></span><br><span class="line">          <span class="comment">## dataId：配置文件的dataId，必须带有后缀</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">dataId:</span> <span class="string">share-config1.properties</span></span><br><span class="line">          <span class="comment">## refresh：指定是否能够动态刷新，默认是false</span></span><br><span class="line">            <span class="attr">refresh:</span> <span class="literal">true</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">dataId:</span> <span class="string">share-config2.properties</span></span><br><span class="line">          <span class="comment">## 指定配置文件的分组，默认是DEFAULT_GROUP</span></span><br><span class="line">            <span class="attr">group:</span> <span class="string">ORDER_GROUP</span></span><br><span class="line">            <span class="attr">refresh:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>想要看到效果，肯定是需要通过<code>@Value()</code>导入配置，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@RefreshScope</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicConfigEntity</span> </span>&#123;</span><br><span class="line">    <span class="comment">//获取共享配置文件中database.url</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;database.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String databaseUrl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取共享配置文件中database.user</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;database.user&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面配置完毕，启动nacos-config-share这个项目，访问：<a target="_blank" rel="noopener" href="http://localhost:9003/nacos/test/1%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%E5%9B%BE%EF%BC%9A">http://localhost:9003/nacos/test/1，结果如下图：</a></p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/44.png"></p>
<p>动态刷新配置这里就不再演示了，自己动手玩一下……</p>
<h2 id="Nacos如何持久化？"><a href="#Nacos如何持久化？" class="headerlink" title="Nacos如何持久化？"></a>Nacos如何持久化？</h2><p>前面讲了这么多，大家有没有思考过一个问题，Nacos的一系列的配置究竟存储在哪里呢？</p>
<p>其实Nacos默认使用的是内嵌的数据库<code>Derby</code>，这个在Nacos-server文件下的<code>/data</code>目录下就可以验证，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/37.png"></p>
<p>那么问题来了，这些配置如何用自己的数据库存储呢？</p>
<blockquote>
<p>目前Nacos仅支持<code>Mysql</code>数据库，且版本要求：<code>5.6.5+</code></p>
</blockquote>
<h3 id="初始化数据库"><a href="#初始化数据库" class="headerlink" title="初始化数据库"></a>初始化数据库</h3><p>首先在Mysql中新建一个数据库<code>nacos-config</code>（名称随意），然后执行Nacos中的SQL脚本，该脚本是Nacos-server文件夹中的<code>nacos-mysql.sql</code>，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/38.png"></p>
<p>执行该脚本，将会自动创建表，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/39.png"></p>
<h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><p>Nacos-server也是一个Spring Boot 项目，想要连接自己的数据库，当然要配置数据源了，那么在哪里配置呢？</p>
<p>配置文件同样在Nacos-server中的conf目录下，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/40.png"></p>
<p>只需要将<code>application.properties</code>中的Mysql配置取消注释并且配置好自己的数据源即可，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/41.png"></p>
<p>修改完毕，重新启动Nacos-server。</p>
<p>如何验证是否持久化呢？很简单，只需要创建一个配置，然后在<code>his_config_info</code>表中查看下是否存在即可，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/42.png"></p>
<h2 id="Nacos集群如何搭建？"><a href="#Nacos集群如何搭建？" class="headerlink" title="Nacos集群如何搭建？"></a>Nacos集群如何搭建？</h2><p>真是够了，又来扯皮高可用了，真是头大……….</p>
<p>Nacos推荐集群模式部署，这样可以避免单点故障，那么如何搭建集群呢？请看官方文档：<a target="_blank" rel="noopener" href="https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html">https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html</a></p>
<p>话不多说，偷一张官网的架构图，如下：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/45.jpg"></p>
<p>上图什么意思呢？说实话，这文档写的真不咋的，很多除初学者一看就懵，请看陈某的架构图，如下：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/46.png"></p>
<p>看了陈某画的图是不是更清楚了呢？请求进来先共同Nginx集群进行转发到Nacos集群中，当然为了保持高可用，数据库必须也是集群模式。</p>
<p>Nacos官方推荐Linux下搭建集群模式，因此陈某尝试在Linux环境下搭建。Nginx和Mysql这里集群就不再演示如何搭建了，不是今天的重点，主要演示下Nacos集群的搭建方法。</p>
<h3 id="下载Linux下的Nacos"><a href="#下载Linux下的Nacos" class="headerlink" title="下载Linux下的Nacos"></a>下载Linux下的Nacos</h3><p>在GitHub上下载自己对应的版本，陈某用的版本是1.2.1，地址：<a target="_blank" rel="noopener" href="https://github.com/alibaba/nacos/releases/tag/1.2.1">https://github.com/alibaba/nacos/releases/tag/1.2.1</a></p>
<p>找到后缀为<code>tar.gz</code>的文件下载，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/47.png"></p>
<h3 id="修改配置文件-1"><a href="#修改配置文件-1" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><p>由于条件限制，陈某仅仅在一台服务器上启动三个Nacos服务演示。Nacos的端口分别为8848、8849、8850。</p>
<h4 id="修改端口号"><a href="#修改端口号" class="headerlink" title="修改端口号"></a>修改端口号</h4><p>Nacos默认的端口号是8848，那么如何修改端口呢？只需要修改<code>conf</code>目录下的<code>application.properties</code>中的<code>server.port</code>即可，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/48.png"></p>
<h4 id="修改集群配置"><a href="#修改集群配置" class="headerlink" title="修改集群配置"></a>修改集群配置</h4><p>那么如何配置集群呢？在<code>conf</code>目录下有一个<code>cluster.conf.example</code>文件，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/49.png"></p>
<p>只需要将<code>cluster.conf.example</code>这个文件复制一份为<code>cluster.conf</code>放在<code>conf</code>目录下，其中配置的内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">172.16.1.84:8848</span><br><span class="line">172.16.1.84:8849</span><br><span class="line">172.16.1.84:8850</span><br></pre></td></tr></table></figure>

<p>什么意思呢？<code>172.16.1.84</code>是服务器的IP地址，这里填写自己服务器的IP，<code>:</code>后面的是Nacos的端口号。</p>
<h4 id="修改数据源"><a href="#修改数据源" class="headerlink" title="修改数据源"></a>修改数据源</h4><p>这个在持久化的那里已经讲过了，只需要将<code>application.properties</code>中的数据源替换掉，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/50.png"></p>
<h3 id="启动Nacos"><a href="#启动Nacos" class="headerlink" title="启动Nacos"></a>启动Nacos</h3><p>经过上述的步骤Nacos集群已经配置好了，现在分别启动Nacos，命令如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -f ./startup.sh</span><br></pre></td></tr></table></figure>

<p>启动成功，访问任意一个端口的Nacos服务，在<code>集群管理-&gt;节点列表</code>中将会看到自己搭建的三个节点，如下图：</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/51.png"></p>
<p>至此，Nacos集群算是搭建完成了……</p>
<h3 id="Nginx中配置"><a href="#Nginx中配置" class="headerlink" title="Nginx中配置"></a>Nginx中配置</h3><p>此处就不演示Nginx集群搭建了，直接在单机的Nginx中配置。直接修改nginx的conf文件，内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">upstream nacos&#123;</span><br><span class="line">		server 172.16.1.84:8848;</span><br><span class="line">		server 172.16.1.84:8849;</span><br><span class="line">		server 172.16.1.84:8850;</span><br><span class="line">	 &#125;</span><br><span class="line">	 </span><br><span class="line">	 server&#123;</span><br><span class="line">		listen 80;</span><br><span class="line">		location / &#123;</span><br><span class="line">			proxy_pass http://nacos;</span><br><span class="line">		&#125;</span><br><span class="line">	 &#125;</span><br></pre></td></tr></table></figure>

<p>相信大家都能看懂，此处就不再做过多解释了…..配置完成后，启动Nginx，直接访问：<a target="_blank" rel="noopener" href="http://ip/nacos%E3%80%82">http://ip/nacos。</a></p>
<h3 id="项目中配置server-addr"><a href="#项目中配置server-addr" class="headerlink" title="项目中配置server-addr"></a>项目中配置server-addr</h3><p>既然搭建了集群，那么项目中也要配置一下，有两种方式，下面分别介绍。</p>
<p>第一种：通过直连的方式配置，如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="comment">## 指定服务名称，在nacos中的名字</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-provider</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="comment"># nacos的服务地址，nacos-server中IP地址:端口号</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">172.16</span><span class="number">.1</span><span class="number">.84</span><span class="string">:8848,172.16.1.84:8849,172.16.1.84:8850</span></span><br></pre></td></tr></table></figure>

<p>第二种：直接连接Nginx，如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="comment">## 指定服务名称，在nacos中的名字</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-provider</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="comment"># nacos的服务地址，nacos-server中IP地址:端口号</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">172.16</span><span class="number">.1</span><span class="number">.84</span><span class="string">:80</span></span><br></pre></td></tr></table></figure>



<h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><p>Nacos集群搭建非常简单，唯一的配置就是<code>cluster.conf</code>中设置三个Nacos服务，这也正是Nacos的设计理念，让开发者能够尽快上手，专注业务的开发。</p>
<h2 id="Nacos是CP还是AP？"><a href="#Nacos是CP还是AP？" class="headerlink" title="Nacos是CP还是AP？"></a>Nacos是CP还是AP？</h2><p>先来简单复习下CAP的概念吧，如下：</p>
<ul>
<li>一致性（C）：在分布式系统中的所有数据备份，在同一时刻是否同样的值。（等同于所有节点访问同一份最新的数据副本）</li>
<li>可用性（A）：在集群中一部分节点故障后，集群整体是否还能响应客户端的读写请求。（对数据更新具备高可用性）</li>
<li>分区容错性（P）：以实际效果而言，分区相当于对通信的时限要求。系统如果不能在时限内达成数据一致性，就意味着发生了分区的情况，必须就当前操作在C和A之间做出选择。</li>
</ul>
<p>一般分布式系统中，肯定是优先保证P，剩下的就是C和A的取舍。</p>
<p><img src="https://gitee.com/chenjiabing666/BlogImage/raw/master/Nacos%E4%BB%8B%E7%BB%8D/52.png"></p>
<p>当然不同的注册中心遵循的CAP也是不同的，如下：</p>
<ul>
<li>Zookeeper：保证CP，放弃可用性；一旦zookeeper集群中master节点宕了，则会重新选举leader，这个过程可能非常漫长，在这过程中服务不可用。</li>
<li>Eureka：保证AP，放弃一致性；Eureka集群中的各个节点都是平等的，一旦某个节点宕了，其他节点正常服务（一旦客户端发现注册失败，则将会连接集群中其他节点），虽然保证了可用性，但是每个节点的数据可能不是最新的。</li>
<li>Nacos：同时支持CP和AP，默认是AP，可以切换；AP模式下以临时实例注册，CP模式下服务永久实例注册。</li>
</ul>
<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>Spring Cloud 进阶这个专栏已经蕴量很久了，前段时间一直忙着工作，铁粉都知道陈某已经完成了两个专栏文章，分别是Spring Boot 进阶、Mybatis 进阶；总之原创不易，且看且珍惜，随手一个赞是美德哦！！！</p>
<blockquote>
<p>以上源码已经上传GitHub，需要的公众号回复关键词<code>9528</code>获取。</p>
</blockquote>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    不才陈某  |  微信公众号【码猿技术专栏】
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://chenjiabing666.github.io/2021/07/31/%E4%BA%94%E5%8D%81%E4%BA%94%E5%BC%A0%E5%9B%BE%E5%91%8A%E8%AF%89%E4%BD%A0%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%81%B5%E9%AD%82%E6%91%86%E6%B8%A1%E8%80%85Nacos%E7%A9%B6%E7%AB%9F%E6%9C%89%E5%A4%9A%E5%BC%BA%EF%BC%9F/" title="五十五张图告诉你微服务灵魂摆渡者Nacos究竟有多强？">https://chenjiabing666.github.io/2021/07/31/五十五张图告诉你微服务灵魂摆渡者Nacos究竟有多强？/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
  <li class="post-copyright-license">
    并保留本声明和上方二维码。感谢您的阅读和支持！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/wechat_channel.jpg">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">微信公众号</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Spring-Cloud/" rel="tag"># Spring Cloud</a>
              <a href="/tags/Nacos/" rel="tag"># Nacos</a>
              <a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag"># 微服务</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/07/31/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E6%B1%87%E6%80%BB/" rel="prev" title="公众号文章汇总">
      <i class="fa fa-chevron-left"></i> 公众号文章汇总
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/07/31/4%E6%AC%BEMySQL%E8%B0%83%E4%BC%98%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%85%AC%E5%8F%B8%E5%A4%A7%E7%A5%9E%E9%83%BD%E5%9C%A8%E7%94%A8%EF%BC%81/" rel="next" title="4款MySQL调优工具，公司大神都在用！">
      4款MySQL调优工具，公司大神都在用！ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

		  <script src="https://readmore.openwrite.cn/js/readmore.js" type="text/javascript"></script>
<script>
    const btw = new BTWPlugin();
    btw.init({
        id: 'container',
        blogId: '27513-1629019452485-311',
        name: '码猿技术专栏',
        qrcode: 'https://gitee.com/chenjiabing666/BlogImage/raw/master/@Async%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8/16.jpg',
        keyword: 'vip',
    });
</script>
        </div>
		</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88Nacos%E8%BF%99%E4%B9%88%E5%8F%97%E6%AC%A2%E8%BF%8E%EF%BC%9F"><span class="nav-text">为什么Nacos这么受欢迎？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E8%87%AA%E5%AD%A6%E5%91%A2%EF%BC%9F"><span class="nav-text">如何自学呢？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AC%E6%96%87%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E"><span class="nav-text">本文版本说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8Nacos%E6%9C%8D%E5%8A%A1"><span class="nav-text">启动Nacos服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%8F%91%E7%8E%B0"><span class="nav-text">服务注册发现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E6%BC%94%E7%A4%BA%E6%95%88%E6%9E%9C%E5%91%A2%EF%BC%9F"><span class="nav-text">如何演示效果呢？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nacos-provider%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E8%80%85%E5%88%9B%E5%BB%BA"><span class="nav-text">nacos-provider服务提供者创建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%B7%BB%E5%8A%A0Maven%E4%BE%9D%E8%B5%96"><span class="nav-text">1. 添加Maven依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E9%85%8D%E7%BD%AEYML%E6%96%87%E4%BB%B6"><span class="nav-text">2. 配置YML文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%BC%80%E5%90%AF%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%8F%91%E7%8E%B0%E5%8A%9F%E8%83%BD"><span class="nav-text">3. 开启服务注册发现功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E5%86%99%E4%B8%AA%E6%BC%94%E7%A4%BA%E6%9C%8D%E5%8A%A1"><span class="nav-text">4. 写个演示服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE"><span class="nav-text">5. 启动项目</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nacos-consumer%E6%9C%8D%E5%8A%A1%E6%B6%88%E8%B4%B9%E8%80%85%E5%88%9B%E5%BB%BA"><span class="nav-text">nacos-consumer服务消费者创建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%B7%BB%E5%8A%A0Maven%E4%BE%9D%E8%B5%96-1"><span class="nav-text">1. 添加Maven依赖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E9%85%8D%E7%BD%AEYML%E6%96%87%E4%BB%B6-1"><span class="nav-text">2. 配置YML文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%BC%80%E5%90%AF%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%8F%91%E7%8E%B0%E5%8A%9F%E8%83%BD-1"><span class="nav-text">3. 开启服务注册发现功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E5%86%99%E4%B8%AA%E6%BC%94%E7%A4%BA%E6%9C%8D%E5%8A%A1-1"><span class="nav-text">4. 写个演示服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE-1"><span class="nav-text">5. 启动项目</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86"><span class="nav-text">启动配置管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E6%BC%94%E7%A4%BA%E6%95%88%E6%9E%9C%E5%91%A2%EF%BC%9F-1"><span class="nav-text">如何演示效果呢？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"><span class="nav-text">添加依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEYAML%E6%96%87%E4%BB%B6"><span class="nav-text">配置YAML文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Data-ID%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-text">Data ID是什么？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E9%85%8D%E7%BD%AE"><span class="nav-text">添加一个配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96nacos%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-text">获取nacos中的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%A6%82%E4%BD%95%E5%8A%A8%E6%80%81%E5%88%B7%E6%96%B0%EF%BC%9F"><span class="nav-text">配置如何动态刷新？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%8E%AF%E5%A2%83%E5%A6%82%E4%BD%95%E9%9A%94%E7%A6%BB%E9%85%8D%E7%BD%AE%EF%BC%9F%EF%BC%88Namespace%EF%BC%89"><span class="nav-text">多环境如何隔离配置？（Namespace）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E4%B8%9A%E5%8A%A1%E9%85%8D%E7%BD%AE%E5%A6%82%E4%BD%95%E9%9A%94%E7%A6%BB%EF%BC%9F-Group"><span class="nav-text">不同业务配置如何隔离？(Group)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos%E5%A6%82%E4%BD%95%E5%85%B1%E4%BA%AB%E9%85%8D%E7%BD%AE%EF%BC%9F"><span class="nav-text">Nacos如何共享配置？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos%E4%B8%AD%E6%96%B0%E5%BB%BA%E5%85%B1%E4%BA%AB%E9%85%8D%E7%BD%AE"><span class="nav-text">Nacos中新建共享配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA%E6%A8%A1%E5%9D%97nacos-config-share"><span class="nav-text">新建模块nacos-config-share</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos%E5%A6%82%E4%BD%95%E6%8C%81%E4%B9%85%E5%8C%96%EF%BC%9F"><span class="nav-text">Nacos如何持久化？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">初始化数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">修改配置文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos%E9%9B%86%E7%BE%A4%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA%EF%BC%9F"><span class="nav-text">Nacos集群如何搭建？</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BDLinux%E4%B8%8B%E7%9A%84Nacos"><span class="nav-text">下载Linux下的Nacos</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1"><span class="nav-text">修改配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E7%AB%AF%E5%8F%A3%E5%8F%B7"><span class="nav-text">修改端口号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE"><span class="nav-text">修改集群配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="nav-text">修改数据源</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8Nacos"><span class="nav-text">启动Nacos</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nginx%E4%B8%AD%E9%85%8D%E7%BD%AE"><span class="nav-text">Nginx中配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E4%B8%AD%E9%85%8D%E7%BD%AEserver-addr"><span class="nav-text">项目中配置server-addr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-2"><span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos%E6%98%AFCP%E8%BF%98%E6%98%AFAP%EF%BC%9F"><span class="nav-text">Nacos是CP还是AP？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E"><span class="nav-text">写在最后</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="不才陈某"
      src="/images/header.jpg">
  <p class="site-author-name" itemprop="name">不才陈某</p>
  <div class="site-description" itemprop="description">本站是不才陈某的技术分享博客。内容涵盖Java后端技术、Spring Boot、微服务架构、系统安全、前端、系统监控等相关的研究与知识分享。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">135</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://gitee.com/chenjiabing666/BlogImage/raw/master/myjszl_log.png" title="微信公众号 → https:&#x2F;&#x2F;gitee.com&#x2F;chenjiabing666&#x2F;BlogImage&#x2F;raw&#x2F;master&#x2F;myjszl_log.png" rel="noopener" target="_blank"><i class="fab fa-weixin fa-fw"></i>微信公众号</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://juejin.im/user/2506542244708072" title="掘金 → https:&#x2F;&#x2F;juejin.im&#x2F;user&#x2F;2506542244708072" rel="noopener" target="_blank"><i class="fab fa-google fa-fw"></i>掘金</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">不才陈某|公众号：码猿技术专栏</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'RtlQOgOT3M0hgyMeogykSQjT-gzGzoHsz',
      appKey     : 'vSCxLU88wnXVf0Pa8mwJrCPm',
      placeholder: "欢迎关注博主微信公众号【码猿技术专栏】",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
